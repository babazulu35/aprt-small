/**
 * @description Simple slider for Aperto test case
 * @author h.huriyet
 */

(function(window, $) {
    "use strict";
    var Aprtslider = function(element, options) {
        this.self = window.self;
        this.element = element;
        this.$element = $(element);
        this.options = options;
        this.flag = {
            isAppended: false
        }


        this.defaults = {
            prevArrow: '<span class="c-slider__arrow-previous"></span>',
            nextArrow: '<span class="c-slider__arrow-next"></span>',
            dots: true,
            dotsClass: '<div class="c-slider__dots"></div>',
            imageSliderClass: 'c-slider--item',
            autoSlide: true,
            slideSpeed: 2000,
        }

    }


    /**
     *  @description InÄ±tialize App
     *  @returns initilialize function 
     */
    Aprtslider.prototype.initialize = function() {
        this.config = $.extend({}, this.defaults, this.options);
        if (!this.flag.isAppended) {
            this.appendSlider();
            this.activateArrowFunc();
            this.flag.isAppended = true;

        }
        if (this.flag.isAppended && this.config.autoSlide) {
            this.autoSlide();
        }
        return this;
    }


    /**
     * slider interval start 
     * @returns interval function
     */
    Aprtslider.prototype.startSliderInterval = function() {
        var self = this;
        var interval = window.setInterval(function() {
            var activeSlide = $('.slider').attr('data-active');
            if (activeSlide < self.allowedMaxStep()) {
                $('.slider').attr('data-active', parseInt(activeSlide) + 1);
                $('.slider').animate({ 'margin-left': -self.$element[0].clientWidth * activeSlide })
                self.dotsActiveElement(activeSlide);
            } else if (activeSlide == self.allowedMaxStep()) {
                $('.slider').attr('data-active', 1);
                $('.slider').animate({ 'margin-left': 0 });
                self.dotsActiveElement(0);
            }
        }, this.defaults.slideSpeed)

        return interval;
    }

    /**
     * @description autoSlide function starts , stops and reset the intervals;
     */
    Aprtslider.prototype.autoSlide = function() {
        var self = this;
        this.interval = this.startSliderInterval();
        this.$element.on('mouseover', function() {
            window.clearInterval(self.interval);
        });
        this.$element.on('mouseout', function() {
            // Restart Interval
            self.interval = self.startSliderInterval();
        })
    }

    /**
     * 
     * @param {number} itemCount
     * @description Slider item count value 
     */
    Aprtslider.prototype.calculateSpace = function(itemCount) {
        var slideSpace = this.$element[0].clientWidth * itemCount;
        return slideSpace;
    }


    /**
     *  @description Append new elements to c-slider 
     */
    Aprtslider.prototype.appendSlider = function() {
        $(this.config.nextArrow).appendTo('.c-slider');
        $(this.config.prevArrow).appendTo('.c-slider');
        if (this.config.dots) $(this.config.dotsClass).appendTo('.c-slider');
        this.$element.append('<div class="slider"></div>');
        var self = this;
        var sliderSet = [];

        for (var i = 0; i < this.$element[0].children.length; i++) {
            if (this.$element[0].children[i].className == this.defaults.imageSliderClass) {
                sliderSet.push(this.$element[0].children[i]);
                continue;
            }
        }

        $.each(sliderSet, function(key, value) {
            if (value.className != undefined) {
                $('.' + value.className).css('width', self.$element[0].clientWidth).appendTo('.slider');
                if (self.config.dots) {
                    $('<div class="c-slider__dots-item"></div>').appendTo('.' + $(self.config.dotsClass)[0].className);
                    $('.c-slider__dots-item').eq(0).addClass('active');
                }
            }

        });
        $('.slider').css({ 'width': this.calculateSpace(sliderSet.length), 'display': 'block', 'margin-left': 0, 'padding': 0 }).attr('data-active', 1);

    }


    /**
     * @description length from the added slider item
     */
    Aprtslider.prototype.allowedMaxStep = function() {
        return $('.slider')[0].children.length;
    }


    /**
     * 
     * @param {number} activeSlide 
     * @description value from activated slide item on page
     */
    Aprtslider.prototype.dotsActiveElement = function(activeSlide) {

        $('.c-slider__dots-item').removeClass('active');
        $('.c-slider__dots-item').eq(activeSlide).addClass('active');
    }


    /**
     * @description goTo next Slide item
     */
    Aprtslider.prototype.nextSlide = function() {

        var self = this;
        $('.' + $(this.config.nextArrow)[0].className).click(function() {

            var activeSlide = $('.slider').attr('data-active');
            if (activeSlide <= self.allowedMaxStep() - 1) {
                $('.slider').attr('data-active', parseInt(activeSlide) + 1);
                $('.slider').animate({ 'margin-left': -self.$element[0].clientWidth * activeSlide })
                self.dotsActiveElement(activeSlide);
            }
        })
    }


    /**
     * @description goTo Previous slide item
     */
    Aprtslider.prototype.previousSlide = function() {
        var self = this;
        $('.' + $(this.config.prevArrow)[0].className).click(function() {
            var activeSlide = $('.slider').attr('data-active');
            if (activeSlide > 1) {
                $('.slider').attr('data-active', activeSlide - 1);
                $('.slider').animate({ 'margin-left': ((-self.$element[0].clientWidth * (activeSlide - 1)) + self.$element[0].clientWidth) })
                self.dotsActiveElement(activeSlide - 2);
            }
        })
    }


    Aprtslider.prototype.activateArrowFunc = function() {
        this.nextSlide();
        this.previousSlide();
    }


    $.fn.aprtslider = function(options) {
        return this.each(function() {

            new Aprtslider(this, options).initialize();
        })
    }

})(window, jQuery);
/**
 * @description Simple image overlay for Aperto test case 
 * @author h.huriyet
 */
(function($) {
    'use strict';
    /**
     * 
     * @param {HTMLElement} element 
     * @param {Object} options 
     */
    var Imagelay = function(element, options) {
        this.element = element;
        this.$element = $(element);
        this.options = options;
        this.attrTag = this.$element.data("imagelay");
        this.flag = {
            open: false, // Open-- Close check flag
        }

        this.defaults = {
            mainClass: 'c-overlay', // Main Overlay Class
            contentClass: 'c-overlay--content', // Overlay Content Class
            closeIcon: 'c-overlay--close', // Overlay Close Buton Class
            animation: 'fadeIn', // Animation Css class,
            closeOnOutsideClick: true, // Close Overlay on Click outside screen

        }
    };


    /**
     * @description initialize app
     * @returns initilaze function
     */
    Imagelay.prototype.initialize = function() {

        this.config = $.extend({}, this.defaults, this.options, this.attrTag);
        this.ready();
        return this;
    }

    /**
     * @description open Overlay with outhside click control
     */
    Imagelay.prototype.open = function() {
        if (!this.flag.open) {
            var self = this;
            $('html').addClass('no-scroll');
            $("body").append(this.bindOverlayToDOM());
            this.flag.open = true;
            if (this.config.closeOnOutsideClick) {
                $("body").click(function(e) {
                    if (e.target.classList[0] == self.config.mainClass) {
                        self.toggle();
                    }
                })
            }
            $("." + this.config.closeIcon).on('click', function() {
                self.toggle();
            })
        }
    }

    /**
     * @description close overlay
     */
    Imagelay.prototype.close = function() {
        if (this.flag.open) {
            $("." + this.config.mainClass).remove();
            $('html').removeClass('no-scroll');
            this.flag.open = false;
        }

    }

    /**
     * @description toggle Open and Close functions with control flag 
     */
    Imagelay.prototype.toggle = function() {
        var self = this;
        if (!self.flag.open) {
            self.open();
        } else {
            self.close();
        }
    }


    /**
     * @description 
     */
    Imagelay.prototype.bindOverlayToDOM = function() {
        console.log(this.$element[0].children[0].outerHTML);
        var template = "<div class='" + this.config.mainClass + " fadeIn' ><div class='" + this.config.contentClass + "'><span class='" + this.config.closeIcon + "'></span>" + this.$element[0].children[0].outerHTML + "</div></div>";
        return template;

    }


    /**
     * @description overlay ready function
     */
    Imagelay.prototype.ready = function() {
        var self = this;

        if (this.attrTag != undefined || this.attrTag != null) {
            console.log(this.$element[0].offsetParent.className);
            if (this.config.bindClickToParent) {
                $('.' + this.$element[0].offsetParent.className).on('click', function() {
                    self.toggle();
                })
            } else {
                this.$element.on('click', function() {
                    self.toggle();
                })
            }



        }
    }

    $.fn.imagelay = function(options) {
        return this.each(function() {
            new Imagelay(this, options).initialize();
        })
    }

})(jQuery);
(function() {

    // Single image overlay 
    // Shows only data-imagelay
    $('.c-text-image__image').imagelay({
        mainClass: 'c-overlay',
        contentClass: 'c-overlay--content',
        closeIcon: 'c-overlay--close',
        animation: 'fadeIn',
        closeOnOutsideClick: true
    });

    $('.c-slider').aprtslider({
        prevArrow: '<span class="c-slider__arrow-previous"></span>',
        nextArrow: '<span class="c-slider__arrow-next"></span>',
        dots: true,
        dotsClass: '<div class="c-slider__dots"></div>',
        imageSliderClass: 'c-slider--item',
        autoSlide: true,
        slideSpeed: 2000,
    });






})();